<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Đăng nhập bằng Username</title>
</head>
<body>
<h2>Đăng nhập hệ thống</h2>
<form id="loginForm">
  <input type="text" id="username" placeholder="Tên đăng nhập" required><br>
  <input type="password" id="password" placeholder="Mật khẩu" required><br>
  <button type="submit">Đăng nhập</button>
</form>
<p id="errorMsg"></p>
<script>
  document.getElementById("loginForm").onsubmit = async function(e) {
    e.preventDefault();
    const username = document.getElementById("username").value;
    const password = document.getElementById("password").value;
    const res = await fetch("http://localhost:8181/api/auth/login", {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify({username, password})
    });
    if(res.ok) {
      const data = await res.json();
      // Lưu token và role vào localStorage
      localStorage.setItem("token", data.token);
      localStorage.setItem("role", data.role);
      window.location = "project.html";
    } else {
      document.getElementById("errorMsg").innerText = "Sai tên đăng nhập hoặc mật khẩu!";
    }
  }
</script>
</body>
</html>
